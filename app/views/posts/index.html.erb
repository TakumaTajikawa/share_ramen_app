<div id="containr">
  <div class="search-container user-container">
    <h3 class="page-title page-title-post-new">ラーメンを検索
      <hr>
    </h3>
    <%= search_form_for @q, :url => {controller: "posts", action: "index"} do |f| %>
      <div class="form-group">
        <%= f.label :store, "店名" %>
        <%= f.search_field :store_cont, placeholder: "店名で検索" %>
      </div>
      <div class="form-group">
        <%= f.label :prefecture, "都道府県" %>
        <%= f.select :prefecture_eq, [["北海道", "1"], ["青森県", "2"], ["岩手県", "3"], ["宮城県", "4"], ["秋田県", "5"], ["山形県", "6"], ["福島県", "7"], ["茨城県", "8"], ["栃木県", "9"], ["群馬県", "10"], ["埼玉県", "11"], ["千葉県", "12"], ["東京都", "13"], ["神奈川県", "14"],["新潟県", "15"], ["富山", "16"], ["石川県", "17"], ["福井県", "18"], ["山梨県", "19"], ["長野県", "20"], ["岐阜県", "21"], ["静岡県", "22"], ["愛知県", "23"], ["三重県", "24"], ["滋賀県", "25"], ["京都府", "26"], ["大阪府", "27"], ["兵庫県", "28"], ["奈良県", "29"], ["和歌山県", "30"], ["鳥取県", "31"], ["島根県", "32"], ["岡山県", "33"], ["広島県", "34"], ["山口県", "35"], ["徳島県", "36"], ["香川県", "37"], ["愛媛県", "38"], ["高知県", "39"], ["福岡県", "40"], ["佐賀県", "41"], ["長崎県", "42"], ["熊本県", "43"], ["大分県", "44"], ["宮崎県" , "45"], ["鹿児島県", "46"], ["沖縄県", "47"]], include_blank: "都道府県で検索" %>
      </div>
      <div class="form-group">
        <%= f.label :genre_eq, "ジャンル" %>
        <%= f.select :genre_eq, [["醤油", "1"], ["味噌", "2"], ["塩", "3"], 
        ["豚骨", "4"], ["坦々麺", "5"], ["辛麺", "6"], ["つけ麺", "7"], 
        ["油そば", "8"]], include_blank: "ジャンルで検索" %>
      </div>
      <div class="form-group">
        <%= f.label :sorts, "並び替え" %>
        <%= f.select( :sorts, {'日付の古い順': 'created_at asc', '日付の新しい順': 'created_at desc', '食べたい！の多い順': 'likes.count desc' }, {include_blank: "選択して下さい"}, {class: 'form-control'}) %>
      </div>
      <div class="form-group">
        <%= f.submit "検索" %>
      </div>
      <div class="form-group">
        <%= link_to "条件を全てクリア", posts_path %>
      </div>
    <% end %>
  </div>
  <% if @posts.blank? %>
    <p>条件に該当する投稿はありません。</p>
  <% else %>
    <div class="ramen-posts-container">
      <% @posts.each do |post| %>
        <div class="ramen-post-container">
          <%= link_to user_path(post.user) do %>
            <% if post.user.image? %>
              <%= image_tag post.user.image.thumb.url, size: "30", class: "user-icon" %>
            <% else %>
              <%= image_tag "default.jpg", alt: "user-icon", size: "30", class: "user-icon" %>
            <% end %>
            <div class="post-user-name-container">
              <%= post.user.name %>
            </div>
          <% end %>
          <%= link_to post_path(post) do %>
            <div class="image-container">
              <%= image_tag post.image.thumb.url, alt: "post-image", size: "250" %>
            </div>
            <div class="store-container">
              <%= post.store %>
            </div>
            <div class="prefecture-container">
              <%= post.prefecture %>
            </div>
          <% end %>
          <% if user_signed_in? %>
            <div class="like-comment-container">
              <div id="likes_buttons_<%= post.id %>">
                <% if post.liked_by?(current_user) %>
                  <div class="likes">
                    <div class="likes-upper">
                      <%= link_to "/posts/#{post.id}/likes" do %>
                        <i class="fas fa-heart"></i>
                        <div class="likes-count">
                          <%= post.likes.count %>
                        </div>
                      <% end %>
                    </div>
                    <div class="likes-lower">
                      <%= link_to post_likes_path(post.id), method: :delete, remote: true do %>
                        <i class="far fa-grin-hearts"></i>
                        <p class="like like-on">食べたい！</p>
                      <% end %>
                    </div>
                  </div>
                <% else %>
                  <div class="likes">
                    <div class="likes-upper">
                      <%= link_to "/posts/#{post.id}/likes" do %>
                        <i class="fas fa-heart"></i>
                        <div class="likes-count">
                          <%= post.likes.count %>
                        </div>
                      <% end %>
                    </div>
                    <div class="likes-lower">
                      <%= link_to post_likes_path(post.id), method: :post, remote: true do %>
                        <i class="far fa-meh"></i>
                        <p class="like like-off">食べたい！</p>
                      <% end %>
                    </div>
                  </div>
                <% end %>
              </div>
              <p class="post-index-comment-count"><%= "コメント#{post.comment.count}件" %></p>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  <% end %>
  <%= paginate @posts %>
</div>

